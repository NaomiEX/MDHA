Loading cuda/cudnn/8.4.1
  Loading requirement: cuda/toolkit/11.7
4
running build
running build_py
creating build
creating build/lib.linux-x86_64-3.8
creating build/lib.linux-x86_64-3.8/functions
copying functions/__init__.py -> build/lib.linux-x86_64-3.8/functions
copying functions/ms_deform_attn_func.py -> build/lib.linux-x86_64-3.8/functions
creating build/lib.linux-x86_64-3.8/modules
copying modules/__init__.py -> build/lib.linux-x86_64-3.8/modules
copying modules/ms_deform_attn.py -> build/lib.linux-x86_64-3.8/modules
running build_ext
creating build/temp.linux-x86_64-3.8
creating build/temp.linux-x86_64-3.8/ibm
creating build/temp.linux-x86_64-3.8/ibm/gpfs
creating build/temp.linux-x86_64-3.8/ibm/gpfs/home
creating build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008
creating build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA
creating build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects
creating build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin
creating build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions
creating build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops
creating build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src
creating build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cpu
creating build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda
gcc -pthread -B /home/made0008/.conda/envs/mdhav3/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -DWITH_CUDA -I/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src -I/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include -I/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/api/include -I/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/TH -I/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/THC -I/app/cuda/toolkit/11.7/include -I/home/made0008/.conda/envs/mdhav3/include/python3.8 -c /ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cpu/ms_deform_attn_cpu.cpp -o build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cpu/ms_deform_attn_cpu.o -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=MultiScaleDeformableAttention -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++14
cc1plus: warning: command line option ‘-Wstrict-prototypes’ is valid for C/ObjC but not for C++
/app/cuda/toolkit/11.7/bin/nvcc -DWITH_CUDA -I/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src -I/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include -I/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/api/include -I/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/TH -I/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/THC -I/app/cuda/toolkit/11.7/include -I/home/made0008/.conda/envs/mdhav3/include/python3.8 -c /ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu -o build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -DCUDA_HAS_FP16=1 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=MultiScaleDeformableAttention -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 -std=c++14
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_im2col_cuda.cuh(261): warning #177-D: variable "q_col" was declared but never referenced
          detected during instantiation of "void ms_deformable_im2col_cuda(cudaStream_t, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *) [with scalar_t=double]" 
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu(64): here

/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_im2col_cuda.cuh(762): warning #177-D: variable "q_col" was declared but never referenced
          detected during instantiation of "void ms_deformable_col2im_cuda(cudaStream_t, const scalar_t *, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *, scalar_t *, scalar_t *) [with scalar_t=double]" 
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu(134): here

/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_im2col_cuda.cuh(872): warning #177-D: variable "q_col" was declared but never referenced
          detected during instantiation of "void ms_deformable_col2im_cuda(cudaStream_t, const scalar_t *, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *, scalar_t *, scalar_t *) [with scalar_t=double]" 
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu(134): here

/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_im2col_cuda.cuh(331): warning #177-D: variable "q_col" was declared but never referenced
          detected during instantiation of "void ms_deformable_col2im_cuda(cudaStream_t, const scalar_t *, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *, scalar_t *, scalar_t *) [with scalar_t=double]" 
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu(134): here

/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_im2col_cuda.cuh(436): warning #177-D: variable "q_col" was declared but never referenced
          detected during instantiation of "void ms_deformable_col2im_cuda(cudaStream_t, const scalar_t *, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *, scalar_t *, scalar_t *) [with scalar_t=double]" 
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu(134): here

/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_im2col_cuda.cuh(544): warning #177-D: variable "q_col" was declared but never referenced
          detected during instantiation of "void ms_deformable_col2im_cuda(cudaStream_t, const scalar_t *, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *, scalar_t *, scalar_t *) [with scalar_t=double]" 
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu(134): here

/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_im2col_cuda.cuh(649): warning #177-D: variable "q_col" was declared but never referenced
          detected during instantiation of "void ms_deformable_col2im_cuda(cudaStream_t, const scalar_t *, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *, scalar_t *, scalar_t *) [with scalar_t=double]" 
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu(134): here

/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu: In function ‘at::Tensor ms_deform_attn_cuda_forward(const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, int)’:
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:34:62: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     AT_ASSERTM(value.type().is_cuda(), "value must be a CUDA tensor");
                                                              ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:35:71: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     AT_ASSERTM(spatial_shapes.type().is_cuda(), "spatial_shapes must be a CUDA tensor");
                                                                       ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:36:74: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     AT_ASSERTM(level_start_index.type().is_cuda(), "level_start_index must be a CUDA tensor");
                                                                          ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:37:69: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     AT_ASSERTM(sampling_loc.type().is_cuda(), "sampling_loc must be a CUDA tensor");
                                                                     ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:38:68: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     AT_ASSERTM(attn_weight.type().is_cuda(), "attn_weight must be a CUDA tensor");
                                                                    ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu: In lambda function:
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:43: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                           ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:172: warning: ‘c10::ScalarType detail::scalar_type(const at::DeprecatedTypeProperties&)’ is deprecated: passing at::DeprecatedTypeProperties to an AT_DISPATCH macro is deprecated, pass an at::ScalarType instead [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                            ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/Dispatch.h:132:1: note: declared here
 inline at::ScalarType scalar_type(const at::DeprecatedTypeProperties& t) {
 ^~~~~~~~~~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:172: warning: ‘c10::ScalarType detail::scalar_type(const at::DeprecatedTypeProperties&)’ is deprecated: passing at::DeprecatedTypeProperties to an AT_DISPATCH macro is deprecated, pass an at::ScalarType instead [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                            ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/Dispatch.h:132:1: note: declared here
 inline at::ScalarType scalar_type(const at::DeprecatedTypeProperties& t) {
 ^~~~~~~~~~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu: In lambda function:
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:1008: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:1094: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:1137: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:1170: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:1253: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:1411: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu: In lambda function:
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:2236: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:2322: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:2365: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:2397: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:2479: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:64:2636: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu: In function ‘std::vector<at::Tensor> ms_deform_attn_cuda_backward(const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, int)’:
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:100:62: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     AT_ASSERTM(value.type().is_cuda(), "value must be a CUDA tensor");
                                                              ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:101:71: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     AT_ASSERTM(spatial_shapes.type().is_cuda(), "spatial_shapes must be a CUDA tensor");
                                                                       ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:102:74: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     AT_ASSERTM(level_start_index.type().is_cuda(), "level_start_index must be a CUDA tensor");
                                                                          ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:103:69: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     AT_ASSERTM(sampling_loc.type().is_cuda(), "sampling_loc must be a CUDA tensor");
                                                                     ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:104:68: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     AT_ASSERTM(attn_weight.type().is_cuda(), "attn_weight must be a CUDA tensor");
                                                                    ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:105:68: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     AT_ASSERTM(grad_output.type().is_cuda(), "grad_output must be a CUDA tensor");
                                                                    ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu: In lambda function:
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:43: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                           ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:1: note: declared here
   DeprecatedTypeProperties & type() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:173: warning: ‘c10::ScalarType detail::scalar_type(const at::DeprecatedTypeProperties&)’ is deprecated: passing at::DeprecatedTypeProperties to an AT_DISPATCH macro is deprecated, pass an at::ScalarType instead [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                             ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/Dispatch.h:132:1: note: declared here
 inline at::ScalarType scalar_type(const at::DeprecatedTypeProperties& t) {
 ^~~~~~~~~~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:173: warning: ‘c10::ScalarType detail::scalar_type(const at::DeprecatedTypeProperties&)’ is deprecated: passing at::DeprecatedTypeProperties to an AT_DISPATCH macro is deprecated, pass an at::ScalarType instead [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                             ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/Dispatch.h:132:1: note: declared here
 inline at::ScalarType scalar_type(const at::DeprecatedTypeProperties& t) {
 ^~~~~~~~~~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu: In lambda function:
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:1018: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:1044: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:1130: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:1173: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:1206: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:1289: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:1450: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:1534: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:1622: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu: In lambda function:
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:2508: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:2533: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:2619: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:2662: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:2694: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:2776: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:2936: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:3019: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.cu:134:3106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
   T * data() const {
 ^ ~~
gcc -pthread -B /home/made0008/.conda/envs/mdhav3/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -DWITH_CUDA -I/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src -I/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include -I/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/api/include -I/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/TH -I/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/THC -I/app/cuda/toolkit/11.7/include -I/home/made0008/.conda/envs/mdhav3/include/python3.8 -c /ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/vision.cpp -o build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/vision.o -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=MultiScaleDeformableAttention -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++14
cc1plus: warning: command line option ‘-Wstrict-prototypes’ is valid for C/ObjC but not for C++
In file included from /ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/vision.cpp:11:
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/ms_deform_attn.h: In function ‘at::Tensor ms_deform_attn_forward(const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, int)’:
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/ms_deform_attn.h:29:20: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     if (value.type().is_cuda())
                    ^
In file included from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/Tensor.h:3,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/Tensor.h:3,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/extension.h:4,
                 from /ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cpu/ms_deform_attn_cpu.h:12,
                 from /ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/ms_deform_attn.h:13,
                 from /ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/vision.cpp:11:
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:30: note: declared here
   DeprecatedTypeProperties & type() const {
                              ^~~~
In file included from /ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/vision.cpp:11:
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/ms_deform_attn.h: In function ‘std::vector<at::Tensor> ms_deform_attn_backward(const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, int)’:
/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/ms_deform_attn.h:51:20: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
     if (value.type().is_cuda())
                    ^
In file included from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/Tensor.h:3,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/Tensor.h:3,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                 from /home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/torch/extension.h:4,
                 from /ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cpu/ms_deform_attn_cpu.h:12,
                 from /ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/ms_deform_attn.h:13,
                 from /ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/vision.cpp:11:
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:216:30: note: declared here
   DeprecatedTypeProperties & type() const {
                              ^~~~
g++ -pthread -shared -B /home/made0008/.conda/envs/mdhav3/compiler_compat -L/home/made0008/.conda/envs/mdhav3/lib -Wl,-rpath=/home/made0008/.conda/envs/mdhav3/lib -Wl,--no-as-needed -Wl,--sysroot=/ build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cpu/ms_deform_attn_cpu.o build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/cuda/ms_deform_attn_cuda.o build/temp.linux-x86_64-3.8/ibm/gpfs/home/made0008/MDHA/projects/mmdet3d_plugin/attentions/ops/src/vision.o -L/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/lib -L/app/cuda/toolkit/11.7/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda_cu -ltorch_cuda_cpp -o build/lib.linux-x86_64-3.8/MultiScaleDeformableAttention.cpython-38-x86_64-linux-gnu.so
running install
running bdist_egg
running egg_info
creating MultiScaleDeformableAttention.egg-info
writing manifest file 'MultiScaleDeformableAttention.egg-info/SOURCES.txt'
writing manifest file 'MultiScaleDeformableAttention.egg-info/SOURCES.txt'
running install_lib
creating build/bdist.linux-x86_64
creating build/bdist.linux-x86_64/egg
creating build/bdist.linux-x86_64/egg/functions
creating build/bdist.linux-x86_64/egg/modules
byte-compiling build/bdist.linux-x86_64/egg/functions/__init__.py to __init__.cpython-38.pyc
byte-compiling build/bdist.linux-x86_64/egg/functions/ms_deform_attn_func.py to ms_deform_attn_func.cpython-38.pyc
byte-compiling build/bdist.linux-x86_64/egg/modules/__init__.py to __init__.cpython-38.pyc
byte-compiling build/bdist.linux-x86_64/egg/modules/ms_deform_attn.py to ms_deform_attn.cpython-38.pyc
byte-compiling build/bdist.linux-x86_64/egg/MultiScaleDeformableAttention.py to MultiScaleDeformableAttention.cpython-38.pyc
creating build/bdist.linux-x86_64/egg/EGG-INFO
copying MultiScaleDeformableAttention.egg-info/PKG-INFO -> build/bdist.linux-x86_64/egg/EGG-INFO
copying MultiScaleDeformableAttention.egg-info/SOURCES.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying MultiScaleDeformableAttention.egg-info/dependency_links.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying MultiScaleDeformableAttention.egg-info/top_level.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/utils/cpp_extension.py:476: UserWarning: Attempted to use ninja as the BuildExtension backend but we could not find ninja.. Falling back to using the slow distutils backend.
  warnings.warn(msg.format('we could not find ninja.'))
/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/torch/utils/cpp_extension.py:387: UserWarning: The detected CUDA version (11.7) has a minor version mismatch with the version that was used to compile PyTorch (11.6). Most likely this shouldn't be a problem.
  warnings.warn(CUDA_MISMATCH_WARN.format(cuda_str_version, torch.version.cuda))
/cm/shared/apps/jupyter/14.0.0/lib/python3.9/site-packages/setuptools/command/install.py:34: SetuptoolsDeprecationWarning: setup.py install is deprecated. Use build and pip and other standards-based tools.
  warnings.warn(
/cm/shared/apps/jupyter/14.0.0/lib/python3.9/site-packages/setuptools/command/easy_install.py:156: EasyInstallDeprecationWarning: easy_install command is deprecated. Use build and pip and other standards-based tools.
  warnings.warn(
zip_safe flag not set; analyzing archive contents...
__pycache__.MultiScaleDeformableAttention.cpython-38: module references __file__
creating dist
removing 'build/bdist.linux-x86_64/egg' (and everything under it)
removing '/ibm/gpfs/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/MultiScaleDeformableAttention-1.0-py3.8-linux-x86_64.egg' (and everything under it)
creating /ibm/gpfs/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/MultiScaleDeformableAttention-1.0-py3.8-linux-x86_64.egg
Extracting MultiScaleDeformableAttention-1.0-py3.8-linux-x86_64.egg to /ibm/gpfs/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages
byte-compiling /ibm/gpfs/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/MultiScaleDeformableAttention-1.0-py3.8-linux-x86_64.egg/MultiScaleDeformableAttention.py to MultiScaleDeformableAttention.cpython-38.pyc
byte-compiling /ibm/gpfs/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/MultiScaleDeformableAttention-1.0-py3.8-linux-x86_64.egg/functions/__init__.py to __init__.cpython-38.pyc
byte-compiling /ibm/gpfs/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/MultiScaleDeformableAttention-1.0-py3.8-linux-x86_64.egg/functions/ms_deform_attn_func.py to ms_deform_attn_func.cpython-38.pyc
byte-compiling /ibm/gpfs/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/MultiScaleDeformableAttention-1.0-py3.8-linux-x86_64.egg/modules/__init__.py to __init__.cpython-38.pyc
byte-compiling /ibm/gpfs/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/MultiScaleDeformableAttention-1.0-py3.8-linux-x86_64.egg/modules/ms_deform_attn.py to ms_deform_attn.cpython-38.pyc
MultiScaleDeformableAttention 1.0 is already the active version in easy-install.pth

Installed /ibm/gpfs/home/made0008/.conda/envs/mdhav3/lib/python3.8/site-packages/MultiScaleDeformableAttention-1.0-py3.8-linux-x86_64.egg
Processing dependencies for MultiScaleDeformableAttention==1.0
Finished processing dependencies for MultiScaleDeformableAttention==1.0
